<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta charset="utf-8"/> <title>Maiden-Permissions</title> <meta name="viewport" content="width=device-width"/> <meta name="description" content="Permission management for maiden"/> <meta name="author" content="Nicolas Hafner &lt;shinmera@tymoon.eu&gt;"/> <style type="text/css"> body{
          max-width: 1024px;
          margin: 0 auto 0 auto;
          font-family: sans-serif;
          color: #333333;
          font-size: 14pt;
          padding: 5px;
      }
      body>header{
          display:flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          max-width: 100%;
          text-align: center;
      }
      body>header img{
          max-width: 50%;
      }
      img{
          max-width: 100%;
          max-height: 100%;
      }
      code{
          font-family: Consolas, Inconsolata, monospace;
      }
      a{
          text-decoration: none;
          color: #0055AA;
      }
      a img{
          border: none;
      }
      #documentation{
          text-align: justify;
      }
      #documentation pre{
          margin-left: 20px;
          overflow: auto;
      }
      #documentation img{
          margin: 5px;
      }
      #symbol-index>ul{
          list-style: none;
          padding: 0;
      }
      #symbol-index .package>ul{
          list-style: none;
          padding: 0 0 0 10px;
      }
      #symbol-index .package .nicknames{
          font-weight: normal;
      }
      #symbol-index .package h4{
          display: inline-block;
          margin: 0;
      }
      #symbol-index .package article{
          margin: 0 0 15px 0;
      }
      #symbol-index .package article header{
          font-size: 1.2em;
          font-weight: normal;
      }
      #symbol-index .package .name{
          margin-right: 5px;
      }
      #symbol-index .package .docstring{
          margin: 0 0 0 15px;
          white-space: pre-wrap;
          font-size: 12pt;
      }
      @media (max-width: 800px){
          body{font-size: 12pt;}
      } </style> </head> <body> <header> <h1>maiden-permissions</h1> <span class="version">0.0.0</span> <p class="description">Permission management for maiden</p> </header> <main> <article id="documentation">  <div><h2>About</h2> <p>This agent implements a permissions system, allowing you to specify more finely-grained who gets to do what.</p> <h2>How To</h2> <p>After adding the agent to the core, you'll first want to call <code><a href="#MAIDEN-PERMISSIONS:GENERATE-TOKEN">generate-token</a></code>, which will return you a new administrator authentication token. You should then use this token in the network/client you want to become administrator on like so:</p> <pre><code>::upgrade to administrator dadwa213185233231...
</code></pre> <p>Note that you will have to repeat this step for every client, unless you also have an <a href="../accounts/">account</a> set up that does the tracking for you. From there on out you can check access to commands and grant people rights, or deny them explicitly.</p> <p>Permissions are modelled as lists of tokens, which form trees. Each token defines a &quot;subtree&quot; that is either granted or denied. In order to specify a denying permission, simply prefix the first token with a bang. Users are also denoted by such permission lists, where the list starts with the user's name, followed by the client's name, followed by its class description. Thus you can increasingly finely grant a specific user, or all users with that name permissions.</p> <p>Beware of simply blanket-granting just a username permissions, though. Some clients cannot always guarantee the authenticity of a username, and it isn't guaranteed that the same username denotes the same individual over different networks anyway.</p> <p>See the symbol index for the possible commands available to manage permissions.</p> </div>  </article> <article id="copyright">  <h2>Copyright</h2> <span>maiden-permissions</span> is licensed under the <span><a href="https://tldrlegal.com/search?q=Artistic">Artistic</a></span> license.  Â© <span>Nicolas Hafner &lt;shinmera@tymoon.eu&gt;</span> .  This library can be obtained on <a href="https://shinmera.com/project/maiden">https://shinmera.com/project/maiden</a>.  </article>  <article id="symbol-index"> <h2>Package Index</h2> <ul><li class="package"> <h3> <a name="MAIDEN-PERMISSIONS" href="#MAIDEN-PERMISSIONS">MAIDEN-PERMISSIONS</a> <span class="nicknames">(ORG.SHIRAKUMO.MAIDEN.AGENTS.PERMISSIONS)</span> </h3> <ul><li> <a name="MAIDEN-PERMISSIONS:ADD-ADMINISTRATOR"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADD-ADMINISTRATOR">ADD-ADMINISTRATOR</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADD-DEFAULT-PERMISSION"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADD-DEFAULT-PERMISSION">ADD-DEFAULT-PERMISSION</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADMINISTRATE-SELF"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADMINISTRATE-SELF">ADMINISTRATE-SELF</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:CHECK-ACCESS"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:CHECK-ACCESS">CHECK-ACCESS</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:DENY"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:DENY">DENY</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:GRANT"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:GRANT">GRANT</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:PERMISSIONS"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:PERMISSIONS">PERMISSIONS</a></code></h4>  </header> <pre class="docstring">This agent provides selective protection of resources by implementing a permissions system. Each user can be granted or denied access to protected resources.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:REMOVE-ADMINISTRATOR"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:REMOVE-ADMINISTRATOR">REMOVE-ADMINISTRATOR</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:REMOVE-DEFAULT-PERMISSION"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:REMOVE-DEFAULT-PERMISSION">REMOVE-DEFAULT-PERMISSION</a></code></h4>  </header> <pre class="docstring"/> </article> </li><li> <a name="MAIDEN-PERMISSIONS:USER"> </a> <article> <header class="class"> <span class="type">class</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:USER">USER</a></code></h4>  </header> <pre class="docstring">Object representing a user on a remote system somewhere.

Users have a name and may be authenticated. Additional properties
are not guaranteed, but may be provided by a client.

See CLIENT-ENTITY
See AUTHENTICATE
See AUTHENTICATED-P
See USERNAME</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:PERMISSION-DENIED"> </a> <article> <header class="condition"> <span class="type">condition</span>  <h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:PERMISSION-DENIED">PERMISSION-DENIED</a></code></h4>  </header> <pre class="docstring">Condition signalled when an attempt is made to access a protected resource the user does not have access to.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:USER"> </a> <article> <header class="accessor"> <span class="type">accessor</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:USER">USER</a></code></h4> <code class="qualifiers"></code> <code class="arguments">OBJECT</code><code>)</code>  </header> <pre class="docstring">Reader for the user object the event relates to.

See USER-EVENT</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADD-ADMINISTRATOR"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADD-ADMINISTRATOR">ADD-ADMINISTRATOR</a></code></h4> <code class="qualifiers"></code> <code class="arguments">NAME &amp;OPTIONAL CLIENT TYPE</code><code>)</code>  </header> <pre class="docstring">Add the user as an administrator.

See MAIDEN-STORAGE:WITH-STORAGE</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADD-DEFAULT-PERMISSION"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADD-DEFAULT-PERMISSION">ADD-DEFAULT-PERMISSION</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM</code><code>)</code>  </header> <pre class="docstring">Add the permission as a default one that is granted to everyone.

See MAIDEN-STORAGE:WITH-STORAGE</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADMINISTRATOR-P"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADMINISTRATOR-P">ADMINISTRATOR-P</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER &amp;OPTIONAL CLIENT TYPE</code><code>)</code>  </header> <pre class="docstring">Returns true if the user is an administrator.

This is the case if the user is in the configuration's
:administrators list.

See MAIDEN-STORAGE:WITH-STORAGE</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ALLOWED-P"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ALLOWED-P">ALLOWED-P</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER PERM</code><code>)</code>  </header> <pre class="docstring">Returns true if the user is allowed access to the given permission.

This is the case if the user is authenticated and
an administrator, or if the permission is covered
by the default permissions or the user's permissions
and is not denied by the user's permissions.

See ADMINISTRATOR-P
See PERM-MATCH-P
See MAIDEN-STORAGE:WITH-STORAGE</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:CHECK-ALLOWED"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:CHECK-ALLOWED">CHECK-ALLOWED</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER PERM</code><code>)</code>  </header> <pre class="docstring">Check whether the user is allowed access to the permission.

If not, an error of type PERMISSION-DENIED is signalled.

See ALLOWED-P
See PERMISSION-DENIED</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:DENY"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:DENY">DENY</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM USER</code><code>)</code>  </header> <pre class="docstring">Deny the permission to the user.

This will simultaneously add the permission to the
user's list of permissions, and remove any granting
permissions that would match it exactly.

See NORMALIZE-PERMISSION
See GRANT</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:GENERATE-TOKEN"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:GENERATE-TOKEN">GENERATE-TOKEN</a></code></h4> <code class="qualifiers"></code> <code class="arguments"></code><code>)</code>  </header> <pre class="docstring">Creates a fresh administration authentication token that can be used to get admin access.

See *TOKENS*</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:GRANT"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:GRANT">GRANT</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM USER</code><code>)</code>  </header> <pre class="docstring">Grant the permission to the user.

This will simultaneously add the permission to the
user's list of permissions, and remove any denying
permissions that would match it. Note that this may
thus grant more than you expect, if there is a 
denying permission that denies more than just this
permission.

See NORMALIZE-PERMISSION
See DENY</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:PERM-MATCH-P"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:PERM-MATCH-P">PERM-MATCH-P</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM &amp;REST MATCHES</code><code>)</code>  </header> <pre class="docstring">Returns true if the permission is allowed by one or more of the matches and not denied by any of them.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:REMOVE-ADMINISTRATOR"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:REMOVE-ADMINISTRATOR">REMOVE-ADMINISTRATOR</a></code></h4> <code class="qualifiers"></code> <code class="arguments">NAME &amp;OPTIONAL CLIENT TYPE</code><code>)</code>  </header> <pre class="docstring">Remove the user as an administrator.

See MAIDEN-STORAGE:WITH-STORAGE</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:REMOVE-DEFAULT-PERMISSION"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:REMOVE-DEFAULT-PERMISSION">REMOVE-DEFAULT-PERMISSION</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM</code><code>)</code>  </header> <pre class="docstring">Remove the permission as a default one so that it is no longer automatically granted to everyone.

See MAIDEN-STORAGE:WITH-STORAGE</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:USER-PERM"> </a> <article> <header class="function"> <span class="type">function</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:USER-PERM">USER-PERM</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER &amp;OPTIONAL CLIENT TYPE</code><code>)</code>  </header> <pre class="docstring">Create a permission that identifies the user, hopefully uniquely.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:NORMALIZE-PERMISSION"> </a> <article> <header class="generic"> <span class="type">generic</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:NORMALIZE-PERMISSION">NORMALIZE-PERMISSION</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM</code><code>)</code>  </header> <pre class="docstring">Attempt to normalise the permission designator.

Returns a list that should properly identify the resource.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:WITH-PERMISSION"> </a> <article> <header class="macro"> <span class="type">macro</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:WITH-PERMISSION">WITH-PERMISSION</a></code></h4> <code class="qualifiers"></code> <code class="arguments">&amp;REST ARGS</code><code>)</code>  </header> <pre class="docstring">Only execute the body if the user is allowed access to the permission.

See ALLOWED-P</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADD-ADMINISTRATOR"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADD-ADMINISTRATOR">add administrator</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER &amp;OPTIONAL CLIENT TYPE</code><code>)</code>  </header> <pre class="docstring">Add a user as an administrator.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADD-DEFAULT-PERMISSION"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADD-DEFAULT-PERMISSION">add default permission</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM</code><code>)</code>  </header> <pre class="docstring">Register a permission branch that should be granted to all users unless explicitly denied.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:ADMINISTRATE-SELF"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:ADMINISTRATE-SELF">upgrade to administrator</a></code></h4> <code class="qualifiers"></code> <code class="arguments">TOKEN</code><code>)</code>  </header> <pre class="docstring">Upgrade yourself to an administrator with an active authorization token. You can generate such a token at the repl with GENERATE-TOKEN.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:CHECK-ACCESS"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:CHECK-ACCESS">check access</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM</code><code>)</code>  </header> <pre class="docstring">Check whether you have access to a permission branch.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:DENY"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:DENY">deny</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER PERM</code><code>)</code>  </header> <pre class="docstring">Deny access to a permission branch to a user.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:GRANT"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:GRANT">grant</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER PERM</code><code>)</code>  </header> <pre class="docstring">Grant access to a permission branch to a user.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:REMOVE-ADMINISTRATOR"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:REMOVE-ADMINISTRATOR">remove administrator</a></code></h4> <code class="qualifiers"></code> <code class="arguments">USER &amp;OPTIONAL CLIENT TYPE</code><code>)</code>  </header> <pre class="docstring">Remove an administrator.</pre> </article> </li><li> <a name="MAIDEN-PERMISSIONS:REMOVE-DEFAULT-PERMISSION"> </a> <article> <header class="command"> <span class="type">command</span>  <code>(</code><h4 class="name"><code><a href="#MAIDEN-PERMISSIONS:REMOVE-DEFAULT-PERMISSION">remove default permission</a></code></h4> <code class="qualifiers"></code> <code class="arguments">PERM</code><code>)</code>  </header> <pre class="docstring">Remove a permission branch that was set as a default.</pre> </article> </li></ul> </li></ul> </article>  </main> </body> </html> 
